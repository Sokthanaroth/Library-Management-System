{% extends "library_app/base.html" %}
{% load static %}

{% block title %}
    {% if obj_type == 'book' %}
        Barcode - {{ obj.title }}
    {% else %}
        Library Card - {{ obj.user.get_full_name|default:obj.user.username }}
    {% endif %}
{% endblock %}

{% block content %}

<div class="container d-flex justify-content-center mt-5">
    {% if obj_type == 'member' %}
    <!-- MEMBER CARD -->
    <div class="id-card shadow-sm">
        <div class="id-header text-center">
            <h5 class="m-0"><i class="bi bi-bank2 me-2"></i>Library Member Card</h5>
        </div>
        <div class="id-body text-center">
            <h6 class="fw-bold mb-1">{{ obj.user.get_full_name|default:obj.user.username }}</h6>
            <small class="text-muted d-block">Member ID: {{ obj.member_id }}</small>
        </div>
        <div class="id-barcode text-center mt-3">
            <img src="{{ barcode_image }}" alt="Barcode" class="barcode-img">
            <div class="barcode-text">{{ barcode_value }}</div>
        </div>
        <div class="id-footer text-center">
            <small>Issued by LMS Library â€¢ Phnom Penh, Cambodia ðŸ‡°ðŸ‡­</small>
        </div>
    </div>
    {% else %}
    <!-- BOOK BARCODE ONLY -->
    <div class="book-barcode text-center">
        <img src="{{ barcode_image }}" alt="Barcode" class="barcode-img">
        <div class="barcode-text mt-2">{{ barcode_value }}</div>
    </div>
    {% endif %}
</div>

<!-- ACTION BUTTONS -->
<div class="text-center mt-4 no-print">
    <button onclick="window.print()" class="btn btn-dark px-4">
        <i class="bi bi-printer me-2"></i> Print
    </button>
    {% if obj_type == 'member' %}
        <a href="{% url 'member_detail' obj.id %}" class="btn btn-outline-secondary px-4 ms-2">
            <i class="bi bi-arrow-left"></i> Back
        </a>
    {% else %}
        <a href="{% url 'book_detail' obj.id %}" class="btn btn-outline-secondary px-4 ms-2">
            <i class="bi bi-arrow-left"></i> Back
        </a>
    {% endif %}
</div>

<style>
/* MEMBER CARD */
.id-card {
    width: 380px;
    background: #fff;
    border-radius: 16px;
    overflow: hidden;
    font-family: 'Poppins', sans-serif;
    border: 1px solid #e5e5e5;
}
.id-header {
    background: linear-gradient(135deg, #0d6efd, #6c757d);
    color: #fff;
    padding: 12px;
}
.id-body {
    padding: 18px 15px;
    text-align: center;
}
.id-barcode {
    padding: 14px 16px 18px;
}
.barcode-img {
    width: 100%;
    max-width: 350px;
    height: 70px;
    object-fit: contain;
}
.barcode-text {
    font-size: 13px;
    font-weight: 600;
    letter-spacing: 2px;
    margin-top: 6px;
}
.id-footer {
    background: #f9f9f9;
    text-align: center;
    padding: 8px;
    font-size: 11px;
    border-top: 1px solid #eee;
}

/* BOOK BARCODE ONLY */
.book-barcode .barcode-img {
    max-width: 300px;
    height: 70px;
    object-fit: contain;
}
.book-barcode .barcode-text {
    font-size: 14px;
    font-weight: bold;
    letter-spacing: 2px;
}

/* PRINT STYLING */
@media print {
    @page {
        margin: 0.5in;
        size: auto;
    }

    body * {
        visibility: hidden;
    }

    {% if obj_type == 'member' %}
    .id-card, .id-card * {
        visibility: visible;
    }
    .id-card {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        box-shadow: none !important;
    }
    {% else %}
    .book-barcode, .book-barcode * {
        visibility: visible;
    }
    .book-barcode {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
    }
    {% endif %}

    .barcode-img {
        height: 80px !important;
    }
    .barcode-text {
        font-size: 16px !important;
        font-weight: bold !important;
        letter-spacing: 3px !important;
        font-family: 'Courier New', monospace !important;
    }

    .no-print {
        display: none !important;
    }
}
</style>

{% endblock %}
